#!/bin/bash

commit_msg_file="$1"
commit_msg=$(cat "$commit_msg_file")

# Extract the first line (label and title)
first_line=$(head -n1 "$commit_msg_file")

# Check if the first line matches the required pattern: [Label] Title
if ! echo "$first_line" | grep -qE '^\[[A-Za-z]+\] .+'; then
  echo "Error: The first line must start with a label (i.e., Feature, Bugfix, Documentation, Git) in square brackets followed by a space and a title."
  exit 1
fi

# Check for an empty second line
second_line=$(sed -n '2p' "$commit_msg_file")
if [ -n "$second_line" ]; then
  echo "Error: The second line must be empty."
  exit 1
fi

# Check for the presence of a detailed description starting from the third line
third_line=$(sed -n '3p' "$commit_msg_file")
if [ -z "$third_line" ]; then
  echo "Error: A detailed description is required after the empty line."
  exit 1
fi

# If all checks pass
exit 0
